<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panel edytora stacji</title>
  <link rel="stylesheet" href="../assets/app.css" />
  <link rel="icon" href="data:," />
  <meta name="robots" content="noindex" />
  <meta name="referrer" content="no-referrer" />
  <style>body{margin:0}</style>
    </head>
  <body>
    <header class="topbar">
      <div class="container topbar-inner">
        <div class="brand">
          <img class="logo" src="../assets/logo_ztk.png" alt="ZTK" />
          <span class="title">ZTKweb<span class="beta">BETA</span> â€” Panel edytora stacji</span>
        </div>
  <div class="topbar-actions">
          <a class="btn-secondary link-plain" href="https://github.com/KibelSMP/ZTKweb/issues/new?template=bug_report.yml" target="_blank" rel="noopener noreferrer" title="ZgÅ‚oÅ› bÅ‚Ä…d w repozytorium">ğŸ ZgÅ‚oÅ› bÅ‚Ä…d</a>
          <a class="btn" href="./lines.html" title="PrzejdÅº do edytora linii">Edytor linii</a>
          <button id="theme-toggle" class="theme-toggle" aria-label="PrzeÅ‚Ä…cz motyw" title="PrzeÅ‚Ä…cz motyw">
            <span class="theme-icon" data-light>â˜€ï¸</span>
            <span class="theme-icon" data-dark>ğŸŒ™</span>
          </button>
        </div>
      </div>
    </header>
  <main class="container">
    <div id="editor-blocker" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="panel">
        <div class="title">Edytor niedostÄ™pny na tym urzÄ…dzeniu</div>
        <div class="desc">Edytor wymaga myszy/trackpada i wiÄ™kszego ekranu. OtwÃ³rz na komputerze z myszÄ… i szerokoÅ›ciÄ… co najmniej 700px.</div>
      </div>
    </div>
      <div id="annotator-panel">
    <div class="annotator-title">Przypisz wspÃ³Å‚rzÄ™dne i typ stacji</div>
    <div class="annotator-row">
      <label for="station-search" class="sr-only">Szukaj stacji</label>
      <input id="station-search" type="text" placeholder="Szukaj stacji..." />
      <label for="station-select" class="sr-only">Wybierz stacjÄ™</label>
      <select id="station-select" title="Wybierz stacjÄ™"></select>
      <label for="station-type" class="sr-only">Typ stacji</label>
      <select id="station-type" title="Typ stacji">
        <option value="">(bez zmiany)</option>
        <option value="passenger">PasaÅ¼erska</option>
        <option value="hub">WÄ™zeÅ‚ (hub)</option>
  <option value="end">Portal do End</option>
  <option value="metro">Przesiadka na metro</option>
      </select>
    </div>
    <div class="annotator-row">
      <label for="new-station-id" class="sr-only">ID nowej stacji</label>
      <input id="new-station-id" type="text" placeholder="ID nowej stacji (np. ABC)" title="ID nowej stacji" />
      <label for="new-station-name" class="sr-only">Nazwa nowej stacji</label>
      <input id="new-station-name" type="text" placeholder="Nazwa nowej stacji" title="Nazwa nowej stacji" />
      <button id="btn-add-station" class="btn btn-success" title="Dodaj stacjÄ™">Dodaj stacjÄ™</button>
    </div>
    <div class="annotator-hint">Kliknij na mapie, aby przypisaÄ‡ wybranej stacji pozycjÄ™ (w %). Punkty zostanÄ… oznaczone na mapie.</div>
    <div class="annotator-actions">
      <button id="btn-import" class="btn btn-info">Importuj stations.json</button>
      <button id="btn-clear-one" class="btn">UsuÅ„ wspÃ³Å‚rzÄ™dne stacji</button>
      <button id="btn-delete-station" class="btn btn-danger" title="UsuÅ„ bieÅ¼Ä…cÄ… stacjÄ™">UsuÅ„ stacjÄ™</button>
      <button id="btn-clear-all" class="btn btn-danger">WyczyÅ›Ä‡ wszystkie</button>
      <button id="btn-download-stations" class="btn btn-success">Pobierz stations.json</button>
      <button id="btn-upload-bg" class="btn btn-info" title="Wgraj tÅ‚o mapy (obraz)">Wgraj tÅ‚o mapy</button>
      <button id="btn-clear-bg" class="btn" title="UsuÅ„ tÅ‚o mapy">UsuÅ„ tÅ‚o</button>
      <input id="bg-upload" type="file" accept="image/*" hidden />
    </div>
    <div id="annotator-status" class="annotator-status">Åadowanie danychâ€¦</div>
      </div>

  <section class="map-section" aria-label="Mapa (panel edytora)">
        <div id="map-viewport">
          <div id="map"></div>
          <div id="map-controls">
            <button id="zoom-in" class="zoom-btn" aria-label="PrzybliÅ¼">+</button>
            <button id="zoom-out" class="zoom-btn" aria-label="Oddal">âˆ’</button>
            <button id="zoom-reset" class="zoom-btn" aria-label="Reset">â¤¿</button>
          </div>
        </div>
      </section>

  </main>
  <script src="../assets/map-zoom.js"></script>
  <script src="../assets/stations.js"></script>
  <script src="../assets/theme-toggle.js"></script>
  <script>
    (function(){
      // Warunki blokady: brak wsparcia dla precyzyjnego wskaÅºnika (touch-only) lub wÄ…ski ekran
      const prefersFine = window.matchMedia('(any-pointer: fine)').matches;
      const wideEnough = window.matchMedia('(min-width: 700px)').matches;
      const shouldBlock = !(prefersFine && wideEnough);
      const blocker = document.getElementById('editor-blocker');
      if (!blocker) return;
      function setBlocked(b){
        blocker.setAttribute('aria-hidden', b ? 'false' : 'true');
        document.body.style.overflow = b ? 'hidden' : '';
      }
      // JeÅ›li blokujemy, zatrzymaj interakcje z mapÄ… i panelem
      if (shouldBlock) {
        setBlocked(true);
        // Opcjonalnie: zdejmij nasÅ‚uchy z mapy (chroni przed przypadkowym uÅ¼yciem w dotyku)
        try { document.getElementById('map').style.pointerEvents = 'none'; } catch {}
      }
      // Przyciski / reagowanie na zmianÄ™ rozmiaru/urzÄ…dzenia
      const mqPointer = window.matchMedia('(any-pointer: fine)');
      const mqWidth = window.matchMedia('(min-width: 700px)');
      function reevaluate(){ setBlocked(!(mqPointer.matches && mqWidth.matches)); }
      mqPointer.addEventListener?.('change', reevaluate);
      mqWidth.addEventListener?.('change', reevaluate);
      window.addEventListener('orientationchange', ()=> setTimeout(reevaluate, 150));
    })();
  </script>
</body>
</html>
